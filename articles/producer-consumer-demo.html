<!doctype html> <html lang=en> <head> <meta charset=UTF-8 /> <meta name=viewport content="width=device-width,initial-scale=1"/> <meta http-equiv=X-UA-Compatible content="ie=edge"/> <link rel="shortcut icon" type=image/png href=/assets/img/favicon.png /> <script src=https://unpkg.com/ionicons@4.5.10-0/dist/ionicons.js></script> <script src=https://cdnjs.cloudflare.com/ajax/libs/webcomponentsjs/2.2.10/webcomponents-bundle.js></script> <script src=https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js></script> <script src=https://kit.fontawesome.com/58854edabd.js crossorigin=anonymous></script> <title>ahenteti notes</title> <script type="text/javascript">window.webpackManifest={
  "index.js": "/js/index.d9528c4df0e3a88f49b6.js",
  "index.css": "/css/index.d9528c4df0e3a88f49b6.css",
  "what-i-have-done-to-add-react-to-my-website.js": "/js/what-i-have-done-to-add-react-to-my-website.7c494fee2df8186a34b3.js",
  "what-i-have-done-to-add-react-to-my-website.css": "/css/what-i-have-done-to-add-react-to-my-website.7c494fee2df8186a34b3.css",
  "slide-in-as-you-scroll-down-cards.js": "/js/slide-in-as-you-scroll-down-cards.cc25268193e043adcd6f.js",
  "slide-in-as-you-scroll-down-cards.css": "/css/slide-in-as-you-scroll-down-cards.cc25268193e043adcd6f.css",
  "javascript-closure.js": "/js/javascript-closure.86d6cecad4f0c5d9baba.js",
  "javascript-closure.css": "/css/javascript-closure.86d6cecad4f0c5d9baba.css",
  "convert-pdf-to-png-using-mozilla-pdfjs-library.js": "/js/convert-pdf-to-png-using-mozilla-pdfjs-library.a4efcce526356e7a1984.js",
  "convert-pdf-to-png-using-mozilla-pdfjs-library.css": "/css/convert-pdf-to-png-using-mozilla-pdfjs-library.a4efcce526356e7a1984.css",
  "how-to-create-tooltips-with-css.js": "/js/how-to-create-tooltips-with-css.34386b6cabbe3718b55e.js",
  "how-to-create-tooltips-with-css.css": "/css/how-to-create-tooltips-with-css.34386b6cabbe3718b55e.css",
  "about.js": "/js/about.820c4239fe9108149b45.js",
  "about.css": "/css/about.820c4239fe9108149b45.css",
  "how-to-stop-a-process-listening-on-a-certain-port-in-windows.js": "/js/how-to-stop-a-process-listening-on-a-certain-port-in-windows.2c4a927cd35a611fae15.js",
  "how-to-stop-a-process-listening-on-a-certain-port-in-windows.css": "/css/how-to-stop-a-process-listening-on-a-certain-port-in-windows.2c4a927cd35a611fae15.css",
  "how-to-show-line-numbers-in-vim.js": "/js/how-to-show-line-numbers-in-vim.472e1cb6090cb3f7a2e3.js",
  "how-to-show-line-numbers-in-vim.css": "/css/how-to-show-line-numbers-in-vim.472e1cb6090cb3f7a2e3.css",
  "springboot-with-react-demo.js": "/js/springboot-with-react-demo.7d10e06a2e660fa4d511.js",
  "springboot-with-react-demo.css": "/css/springboot-with-react-demo.7d10e06a2e660fa4d511.css",
  "old-versus-new-jsf-scope-annotations.js": "/js/old-versus-new-jsf-scope-annotations.945f60a682213c3215e8.js",
  "old-versus-new-jsf-scope-annotations.css": "/css/old-versus-new-jsf-scope-annotations.945f60a682213c3215e8.css",
  "jsf-websocket-demo.js": "/js/jsf-websocket-demo.c5593744daeba27d3c9f.js",
  "jsf-websocket-demo.css": "/css/jsf-websocket-demo.c5593744daeba27d3c9f.css",
  "jsf-primefaces-demo.js": "/js/jsf-primefaces-demo.7fe866dfe45933509c2e.js",
  "jsf-primefaces-demo.css": "/css/jsf-primefaces-demo.7fe866dfe45933509c2e.css",
  "jsf-helloworld-demo.js": "/js/jsf-helloworld-demo.e53c1d81f126c628ffad.js",
  "jsf-helloworld-demo.css": "/css/jsf-helloworld-demo.e53c1d81f126c628ffad.css",
  "jsf-download-file-demo.js": "/js/jsf-download-file-demo.b4cc86d18d12ea66f462.js",
  "jsf-download-file-demo.css": "/css/jsf-download-file-demo.b4cc86d18d12ea66f462.css",
  "facelet-templating-system.js": "/js/facelet-templating-system.1cf2a45d1d08deda066d.js",
  "facelet-templating-system.css": "/css/facelet-templating-system.1cf2a45d1d08deda066d.css",
  "facelet-composite-components-demo.js": "/js/facelet-composite-components-demo.19bd6fe3b6b7cb91c894.js",
  "facelet-composite-components-demo.css": "/css/facelet-composite-components-demo.19bd6fe3b6b7cb91c894.css",
  "crud-operations-with-jsf-and-primafaces.js": "/js/crud-operations-with-jsf-and-primafaces.945bf7859699f9f5ed6c.js",
  "crud-operations-with-jsf-and-primafaces.css": "/css/crud-operations-with-jsf-and-primafaces.945bf7859699f9f5ed6c.css",
  "validate-ip-addresses-with-java.js": "/js/validate-ip-addresses-with-java.37f9e9aa16d180663cfa.js",
  "validate-ip-addresses-with-java.css": "/css/validate-ip-addresses-with-java.37f9e9aa16d180663cfa.css",
  "simpledateformat-thread-safety-issues.js": "/js/simpledateformat-thread-safety-issues.4a0f328889a14770bce9.js",
  "simpledateformat-thread-safety-issues.css": "/css/simpledateformat-thread-safety-issues.4a0f328889a14770bce9.css",
  "scatter-gather-pattern.js": "/js/scatter-gather-pattern.7deeaf6a415d575f988e.js",
  "scatter-gather-pattern.css": "/css/scatter-gather-pattern.7deeaf6a415d575f988e.css",
  "producer-consumer-demo.js": "/js/producer-consumer-demo.0330cbd62d8f147bb0c0.js",
  "producer-consumer-demo.css": "/css/producer-consumer-demo.0330cbd62d8f147bb0c0.css",
  "how-to-create-your-first-maven-plugin.js": "/js/how-to-create-your-first-maven-plugin.fa69c356573139e01d3f.js",
  "how-to-create-your-first-maven-plugin.css": "/css/how-to-create-your-first-maven-plugin.fa69c356573139e01d3f.css",
  "jdbc-with-and-without-jpa.js": "/js/jdbc-with-and-without-jpa.876f9eab326ddf643f46.js",
  "jdbc-with-and-without-jpa.css": "/css/jdbc-with-and-without-jpa.876f9eab326ddf643f46.css",
  "jackson-custom-deserialization-overview.js": "/js/jackson-custom-deserialization-overview.3c580a6614e00bf240e3.js",
  "jackson-custom-deserialization-overview.css": "/css/jackson-custom-deserialization-overview.3c580a6614e00bf240e3.css",
  "how-to-run-a-jar-file-from-command-line.js": "/js/how-to-run-a-jar-file-from-command-line.b695d7cf753cda19832f.js",
  "how-to-run-a-jar-file-from-command-line.css": "/css/how-to-run-a-jar-file-from-command-line.b695d7cf753cda19832f.css",
  "how-to-reverse-a-string-in-java.js": "/js/how-to-reverse-a-string-in-java.d03814765e454c0722a9.js",
  "how-to-reverse-a-string-in-java.css": "/css/how-to-reverse-a-string-in-java.d03814765e454c0722a9.css",
  "how-to-find-local-non-loopback-address-in-java.js": "/js/how-to-find-local-non-loopback-address-in-java.dd92026687aa208f8925.js",
  "how-to-find-local-non-loopback-address-in-java.css": "/css/how-to-find-local-non-loopback-address-in-java.dd92026687aa208f8925.css",
  "how-to-create-executable-jar-file-using-maven.js": "/js/how-to-create-executable-jar-file-using-maven.a9f2b7c64c094fb47454.js",
  "how-to-create-executable-jar-file-using-maven.css": "/css/how-to-create-executable-jar-file-using-maven.a9f2b7c64c094fb47454.css",
  "how-to-create-a-postgres-jdbc-connection-in-java-se.js": "/js/how-to-create-a-postgres-jdbc-connection-in-java-se.81bd42eaff2c32ab329c.js",
  "how-to-create-a-postgres-jdbc-connection-in-java-se.css": "/css/how-to-create-a-postgres-jdbc-connection-in-java-se.81bd42eaff2c32ab329c.css",
  "how-to-build-graph-structure-in-java.js": "/js/how-to-build-graph-structure-in-java.9dd0698895a5cbca1fe5.js",
  "how-to-build-graph-structure-in-java.css": "/css/how-to-build-graph-structure-in-java.9dd0698895a5cbca1fe5.css",
  "strong-password-hacker-rank-problem.js": "/js/strong-password-hacker-rank-problem.08113c6412c498036978.js",
  "strong-password-hacker-rank-problem.css": "/css/strong-password-hacker-rank-problem.08113c6412c498036978.css",
  "new-year-chaos-hacker-rank-problem.js": "/js/new-year-chaos-hacker-rank-problem.96b82f5cc8e3102e57f3.js",
  "new-year-chaos-hacker-rank-problem.css": "/css/new-year-chaos-hacker-rank-problem.96b82f5cc8e3102e57f3.css",
  "java-stack-hacker-rank-problem.js": "/js/java-stack-hacker-rank-problem.34c069a21466265b054a.js",
  "java-stack-hacker-rank-problem.css": "/css/java-stack-hacker-rank-problem.34c069a21466265b054a.css",
  "java-sha-256-hacker-rank-problem.js": "/js/java-sha-256-hacker-rank-problem.19f430bd19d762b68416.js",
  "java-sha-256-hacker-rank-problem.css": "/css/java-sha-256-hacker-rank-problem.19f430bd19d762b68416.css",
  "java-dequeue-hacker-rank-problem.js": "/js/java-dequeue-hacker-rank-problem.7477af3153f37f91c1f0.js",
  "java-dequeue-hacker-rank-problem.css": "/css/java-dequeue-hacker-rank-problem.7477af3153f37f91c1f0.css",
  "java-1d-array-part-2-hacker-rank-problem.js": "/js/java-1d-array-part-2-hacker-rank-problem.9eabb1475eddc8e6f645.js",
  "java-1d-array-part-2-hacker-rank-problem.css": "/css/java-1d-array-part-2-hacker-rank-problem.9eabb1475eddc8e6f645.css",
  "duplicate-words-hacker-rank-problem.js": "/js/duplicate-words-hacker-rank-problem.8281fba1a576df645dc8.js",
  "duplicate-words-hacker-rank-problem.css": "/css/duplicate-words-hacker-rank-problem.8281fba1a576df645dc8.css",
  "array-manipulation-hacker-rank-problem.js": "/js/array-manipulation-hacker-rank-problem.b9f08372308614951bec.js",
  "array-manipulation-hacker-rank-problem.css": "/css/array-manipulation-hacker-rank-problem.b9f08372308614951bec.css",
  "secure-connnections-with-ssl.js": "/js/secure-connnections-with-ssl.c49c6450df86547eb0e2.js",
  "secure-connnections-with-ssl.css": "/css/secure-connnections-with-ssl.c49c6450df86547eb0e2.css",
  "openssl-quick-tips.js": "/js/openssl-quick-tips.bba163527c89bc1ae50a.js",
  "openssl-quick-tips.css": "/css/openssl-quick-tips.bba163527c89bc1ae50a.css",
  "git-quick-tips.js": "/js/git-quick-tips.b22e3ecdd77a1fe88332.js",
  "git-quick-tips.css": "/css/git-quick-tips.b22e3ecdd77a1fe88332.css",
  "tabs-widget-demo.js": "/js/tabs-widget-demo.bb973e3fe3aa6ee82b89.js",
  "tabs-widget-demo.css": "/css/tabs-widget-demo.bb973e3fe3aa6ee82b89.css",
  "javascript-classes.js": "/js/javascript-classes.b4c38dc04490788cfb3d.js",
  "javascript-classes.css": "/css/javascript-classes.b4c38dc04490788cfb3d.css",
  "html2canvas-script-demo.js": "/js/html2canvas-script-demo.c391b7f669c1ddca2ba7.js",
  "html2canvas-script-demo.css": "/css/html2canvas-script-demo.c391b7f669c1ddca2ba7.css",
  "how-to-draw-a-triangle-with-css.js": "/js/how-to-draw-a-triangle-with-css.6aa9fe993a84907e670b.js",
  "how-to-draw-a-triangle-with-css.css": "/css/how-to-draw-a-triangle-with-css.6aa9fe993a84907e670b.css",
  "how-to-center-horizontally-an-anchor-element.js": "/js/how-to-center-horizontally-an-anchor-element.9968ced939824858d93f.js",
  "how-to-center-horizontally-an-anchor-element.css": "/css/how-to-center-horizontally-an-anchor-element.9968ced939824858d93f.css",
  "how-to-add-ellipsis-to-text-when-overflow-in-css.js": "/js/how-to-add-ellipsis-to-text-when-overflow-in-css.2e09fa848b35bae7a9ad.js",
  "how-to-add-ellipsis-to-text-when-overflow-in-css.css": "/css/how-to-add-ellipsis-to-text-when-overflow-in-css.2e09fa848b35bae7a9ad.css",
  "bash-quick-tips.js": "/js/bash-quick-tips.41661674d8e5e226d65e.js",
  "bash-quick-tips.css": "/css/bash-quick-tips.41661674d8e5e226d65e.css",
  "common.js": "/js/common.92c065e908d6a82c89cf.js",
  "common.css": "/css/common.92c065e908d6a82c89cf.css",
  "webcomponents.js": "/js/webcomponents.6a3558a0b59c3de7ad21.js",
  "highlightStyle.js": "/js/highlightStyle.869aebaad965b5d3647d.js",
  "highlightStyle.css": "/css/highlightStyle.869aebaad965b5d3647d.css",
  "assets/fonts/how-to-build-graph-structure-in-java.svg": "/assets/fonts/how-to-build-graph-structure-in-java.svg",
  "assets/img/imt-atlantique-logo-transparent.png": "/assets/img/imt-atlantique-logo-transparent.png",
  "assets/img/supcom-logo-transparent.png": "/assets/img/supcom-logo-transparent.png",
  "assets/fonts/get-prices-workflow-solution0.svg": "/assets/fonts/get-prices-workflow-solution0.svg",
  "assets/fonts/get-prices-workflow-solution1.svg": "/assets/fonts/get-prices-workflow-solution1.svg",
  "assets/fonts/get-prices-workflow-solution2.svg": "/assets/fonts/get-prices-workflow-solution2.svg",
  "assets/fonts/java-arraylist-chacker-rank-problem.svg": "/assets/fonts/java-arraylist-chacker-rank-problem.svg",
  "assets/fonts/array-manipulation-hacker-rank-problem.svg": "/assets/fonts/array-manipulation-hacker-rank-problem.svg",
  "assets/fonts/encryption_decryption_overview.svg": "/assets/fonts/encryption_decryption_overview.svg",
  "assets/fonts/digital-signature.svg": "/assets/fonts/digital-signature.svg",
  "assets/fonts/obtaining-digital-certificate-procedure.svg": "/assets/fonts/obtaining-digital-certificate-procedure.svg",
  "assets/fonts/ssl-connection.svg": "/assets/fonts/ssl-connection.svg",
  "assets/fonts/capgemini-logo-transparent.svg": "/assets/fonts/capgemini-logo-transparent.svg"
}</script><link href="/css/highlightStyle.869aebaad965b5d3647d.css" rel="stylesheet"><link href="/css/producer-consumer-demo.0330cbd62d8f147bb0c0.css" rel="stylesheet"></head>  <body> <div class=pre-page-loader> <div class=loader> <div></div> <div></div> <div></div> <div></div> <div></div> <div></div> <div></div> <div></div> </div> </div>  <div class=page-content> <header></header> <article-webcomponent> <h2>Overview</h2> <p class=mb-s> In this demo, I will show you how we can implement the Producer-Consumer pattern in java. This pattern is baed a <span class=code>Storage</span> where </p> <ul> <li> multiple <span class=code>Producer</span> can add items and wait if no space is available on the storage </li> <li> multiple <span class=code>Consumer</span> can process items and wait if no item is available on the storage </li> </ul> <h2>Storage implementation steps</h2> <p> The difficulty in this pattern is how to implement the <span class=code>Storage</span> <span class=code>add</span> and <span class=code>remove</span> methods </p> <div class=steps> <h3 class=step>Initial version</h3> <p>In this initial version, we are not going to handle concurrency and Storage maxSize problems</p> <multiline-code-webcomponent language=java> <pre slot=code>
              <code>
                  private final Queue&lt;E&gt; queue;

                  public void add(E e) {
                      queue.add(e);
                  }
              
                  public E remove() {
                      return queue.remove();
                  }
              </code>
            </pre> </multiline-code-webcomponent> <h3 class=step>Handle Concurrency</h3> <p> Since they are going to be multiple threads trying to access the queue, we need to protect it from the simultaneous access. For this, we are going to add <span class=code>Lock</span> in our implementation. So any thread which want to modify the queue by adding or removing an item from it, first it needs to acquire the <span class=code>Lock</span> to access the queue and release it when it finishes </p> <multiline-code-webcomponent language=java> <pre slot=code>
              <code>
                  private final Queue&lt;E&gt; queue;
                  private final Lock lock;

                  public void add(E e) {
                      lock.lock();
                      try {
                          queue.add(e);
                      } finally {
                          lock.unlock();
                      }
                  }
              
                  public E remove() {
                      lock.lock();
                      try {
                          return queue.remove();
                      } finally {
                          lock.unlock();
                      }
                  }
              </code>
            </pre> </multiline-code-webcomponent> <h3 class=step>Handle Storage capacity</h3> <p class=mb-s>The last feature that we need to implement in our <span class=code>Storage</span> is</p> <ul> <li>if the queue is full, we had to block the thread in the <span class=code>add</span> operation</li> <li>if the queue is empty, we had to block the thread in the <span class=code>remove</span> operation</li> </ul> <p> In this implementation, we will use <span class=code>Condition</span> that comes along <span class=code>Lock</span> object. So we are going to create two conditions: </p> <multiline-code-webcomponent language=java> <pre slot=code>
              <code>
                Condition notFull = this.lock.newCondition();
                Condition notEmpty = this.lock.newCondition();
              </code>
            </pre> </multiline-code-webcomponent> <p> In the <span class=code>add</span> operation, if the queue is full, we will wait for the <span class=code>notFull</span> condition to be triggered. So the thread will wait for someone to say that the queue is not full any more, so that it can proceed and <span class=code>add</span> its item. For this we will use <span class=code>notFull.await()</span> which releases the <span class=code>Lock</span> and let the thread goes to the wait state if the condition is not yet satisfied </p> <p> Similarly, in the <span class=code>remove</span> operation, if the queue is empty, we will wait for the <span class=code>notEmpty</span> condition to be triggered. So the thread will wait for someone to say that the queue is not empty any more, so that it can proceed and <span class=code>take</span> an item. For this we will use <span class=code>notEmpty.await()</span> which releases the <span class=code>Lock</span> and let the thread goes to the wait state if the condition is not yet satisfied </p> <p class=mb-s> At this point, our producers and consumers will be waiting for new condition to be satisfied, but we need to trigger these conditions at certain point in our code. That's why we are going to trigger the </p> <ul> <li><span class=code>notEmpty</span> condition on the <span class=code>add</span> operation</li> <li><span class=code>notFull</span> condition on the <span class=code>remove</span> operation</li> </ul> <multiline-code-webcomponent language=java> <pre slot=code>
              <code>
                private final Queue&lt;E&gt; queue;
                private final int maxSize;
                private final Lock lock;
                private final Condition notFull;
                private final Condition notEmpty;
            
                public void add(E e) throws InterruptedException {
                    lock.lock();
                    try {
                        while (queue.size() == maxSize) {
                            this.notFull.await();
                        }
                        queue.add(e);
                        notEmpty.signal();
                    } finally {
                        lock.unlock();
                    }
                }
            
                public E remove() throws InterruptedException {
                    lock.lock();
                    try {
                        while (queue.isEmpty()) {
                            notEmpty.await();
                        }
                        E e = queue.remove();
                        notFull.signal();
                        return e;
                    } finally {
                        lock.unlock();
                    }
                }
              </code>
            </pre> </multiline-code-webcomponent> </div> <h2>Full Implementation</h2> <code-tabs-webcomponent> <code-tab-webcomponent slot=code-tab>Storage.java</code-tab-webcomponent> <code-panel-webcomponent slot=code-panel> <multiline-code-webcomponent language=java> <pre slot=code>
                        <code>
                            package io.github.ahenteti.java;
                            
                            public interface Storage&lt;E&gt; {
                            
                                /**
                                 * Inserts the specified element into this queue, waiting if necessary
                                 * for space to become available.
                                 *
                                 * @param e the element to add
                                 * @throws InterruptedException if interrupted while waiting
                                 */
                                void add(E e) throws InterruptedException;
                            
                                /**
                                 * Retrieves and removes the head of this queue, waiting if necessary
                                 * until an element becomes available.
                                 *
                                 * @return the head of this queue
                                 * @throws InterruptedException if interrupted while waiting
                                 */
                                E remove() throws InterruptedException;
                            
                            }
                        </code>
                    </pre> </multiline-code-webcomponent> </code-panel-webcomponent> <code-tab-webcomponent slot=code-tab>StorageImpl.java</code-tab-webcomponent> <code-panel-webcomponent slot=code-panel> <multiline-code-webcomponent language=java> <pre slot=code>
                        <code>
                            package io.github.ahenteti.java;
                            
                            import java.util.LinkedList;
                            import java.util.Queue;
                            import java.util.concurrent.locks.Condition;
                            import java.util.concurrent.locks.Lock;
                            import java.util.concurrent.locks.ReentrantLock;
                            
                            /**
                             * Storage implementation based java.util.concurrent.ArrayStorage implementation
                             */
                            public class StorageImpl&lt;E&gt; implements Storage&lt;E&gt; {
                            
                                private final Queue&lt;E&gt; queue;
                                private final int maxSize;
                                private final Lock lock;
                                private final Condition notFull;
                                private final Condition notEmpty;
                            
                                public StorageImpl(int maxSize) {
                                    this.queue = new LinkedList&lt;&gt;();
                                    this.maxSize = maxSize;
                                    this.lock = new ReentrantLock(true);
                                    this.notFull = this.lock.newCondition();
                                    this.notEmpty = this.lock.newCondition();
                                }
                            
                                @Override
                                public void add(E e) throws InterruptedException {
                                    lock.lock();
                                    try {
                                        while (queue.size() == maxSize) {
                                            this.notFull.await();
                                        }
                                        queue.add(e);
                                        notEmpty.signal();
                                    } finally {
                                        lock.unlock();
                                    }
                                }
                            
                                @Override
                                public E remove() throws InterruptedException {
                                    lock.lock();
                                    try {
                                        while (queue.isEmpty()) {
                                            notEmpty.await();
                                        }
                                        E e = queue.remove();
                                        notFull.signal();
                                        return e;
                                    } finally {
                                        lock.unlock();
                                    }
                                }
                            }
                        </code>
                    </pre> </multiline-code-webcomponent> </code-panel-webcomponent> <code-tab-webcomponent slot=code-tab>Producer.java</code-tab-webcomponent> <code-panel-webcomponent slot=code-panel> <multiline-code-webcomponent language=java> <pre slot=code>
                        <code>
                            package io.github.ahenteti.java;
                            
                            public class Producer implements Runnable {
                            
                                private final String name;
                                private final Storage&lt;String&gt; queue;
                                private final int processDuration;
                            
                                public Producer(String name, Storage&lt;String&gt; queue, int processDuration) {
                                    this.name = name;
                                    this.queue = queue;
                                    this.processDuration = processDuration;
                                }
                            
                                @Override
                                public void run() {
                                    int index = 0;
                                    while (true) {
                                        try {
                                            queue.add("item" + index++ + " from " + name);
                                            Thread.sleep(processDuration);
                                        } catch (InterruptedException e) {
                                            e.printStackTrace();
                                        }
                                    }
                                }
                            }
                        </code>
                    </pre> </multiline-code-webcomponent> </code-panel-webcomponent> <code-tab-webcomponent slot=code-tab>Consumer.java</code-tab-webcomponent> <code-panel-webcomponent slot=code-panel> <multiline-code-webcomponent language=java> <pre slot=code>
                        <code>
                            package io.github.ahenteti.java;
                            
                            public class Consumer implements Runnable {
                                private final Storage&lt;String&gt; queue;
                                private final int processDuration;
                            
                                public Consumer(Storage&lt;String&gt; queue, int processDuration) {
                                    this.queue = queue;
                                    this.processDuration = processDuration;
                                }
                            
                                @Override
                                public void run() {
                                    while (true) {
                                        try {
                                            String item = queue.remove();
                                            System.out.println("processing: " + item);
                                            Thread.sleep(processDuration);
                                        } catch (InterruptedException e) {
                                            e.printStackTrace();
                                        }
                                    }
                                }
                            }
                        </code>
                    </pre> </multiline-code-webcomponent> </code-panel-webcomponent> <code-tab-webcomponent slot=code-tab>Main.java</code-tab-webcomponent> <code-panel-webcomponent slot=code-panel> <multiline-code-webcomponent language=java> <pre slot=code>
                        <code>
                            package io.github.ahenteti.java;
                            
                            
                            public class Main {
                            
                                public static void main(String[] args) throws InterruptedException {
                                    Storage&lt;String&gt; queue = new StorageImpl&lt;&gt;(10);
                            
                                    new Thread(new Producer("producer1", queue, 100)).start();
                                    new Thread(new Producer("producer2", queue, 200)).start();
                                    new Thread(new Consumer(queue, 300)).start();
                                    new Thread(new Consumer(queue, 400)).start();
                            
                                    Thread.sleep(3000);
                                    System.exit(0);
                                }
                            }
                        </code>
                    </pre> </multiline-code-webcomponent> </code-panel-webcomponent> <code-tab-webcomponent slot=code-tab>Output</code-tab-webcomponent> <code-panel-webcomponent slot=code-panel> <multiline-code-webcomponent language=java> <pre slot=code>
                <code>
                  processing: item0 from producer1
                  processing: item0 from producer2
                  processing: item1 from producer1
                  processing: item2 from producer1
                  processing: item1 from producer2
                  processing: item3 from producer1
                  processing: item4 from producer1
                  processing: item2 from producer2
                  processing: item5 from producer1
                  processing: item6 from producer1
                  processing: item3 from producer2
                  processing: item7 from producer1
                </code>
              </pre> </multiline-code-webcomponent> </code-panel-webcomponent> </code-tabs-webcomponent> <more-info-webcomponent> <link-webcomponent href="https://www.youtube.com/watch?v=UOr9kMCCa5g&t=463s" label="Defog Teck - Implement Producer Consumer pattern youtube video"></link-webcomponent> <link-webcomponent href=https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ArrayStorage.html label="java.util.concurrent.ArrayStorage source code"></link-webcomponent> <link-webcomponent href=https://github.com/ahenteti/ahenteti.github.io.demo/tree/master/java/producer-consumer-demo label="Article source code"></link-webcomponent> </more-info-webcomponent> </article-webcomponent> </div> <script type="text/javascript" src="/js/highlightStyle.869aebaad965b5d3647d.js"></script><script type="text/javascript" src="/js/producer-consumer-demo.0330cbd62d8f147bb0c0.js"></script></body> </html> 